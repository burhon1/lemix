{% extends 'atomic/theme.html' %}
{% load static %}
{% load custom_tags %}
{% load user_tags %}
{% block title %}
Lidlar Ro'yxati- Lemix
{% endblock %}

{% block style %}
<style>
    .cardPay {
        position: relative;
    }

    .cardPay:hover {
        border: 1px solid #5f63f2;

    }

    .cardPay:hover::after {
        content: "";
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        top: 0;
        border-radius: 5px;
        height: 100%;
        width: 100%;
        background-color: #5f63f288;
    }

    .feature-card--1 figcaption h5 {
        margin: 0 0 0.5rem 0 !important;
    }

    .feature-cards:hover {
        cursor: pointer;
        box-shadow: 0 0 5px #5f63f2;
    }

    .atbd-tab .tab-content p {
        font-size: 12px !important;
    }

    .v-num {
        font-size: 14px;
    }

    .application-faqs .panel-title a {
        font-size: 12px !important;
    }

    .forms-view {
        display: flex;
        flex-wrap: wrap;
    }

    .forms-view>.form-group {
        display: flex;
        align-items: center;
    }

    .table-responsive tr td>div {
        text-transform: none;
    }

    .atbd-select .select2-selection,
    .select2-container--default .select2-selection--single {
        height: 1.875rem;
        padding: 0;
        font-size: 12px;
        line-height: 1.5;
        -webkit-border-radius: 0.2rem;
        border-radius: 0.2rem;
        margin-right: 7px;
    }
</style>
{% endblock %}

{% block content %}
        
<div class="atbd-page-content">

    <div class="container-fluid">
        <div class="mt-3">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb-main d-flex justify-content-between mt-4 align-items-center">
                        <h4 class=" breadcrumb-title" >Lidlar - {{leads.count}}ta</h4>
                        <div class="breadcrumb-action justify-content-center flex-wrap">
                            <div class="has-subMenu-left  d-flex ">
                                <button class="btn btn-primary btn-xs ml-3 drawer-trigger" data-drawer="profile"
                                onclick="checkedLeads()"> <span data-feather="mail"></span> SMS jo'natish</button>
                                <button class="btn btn-primary btn-xs ml-3 drawer-trigger"
                                    data-drawer="account">+ Lid qo'shish</button>
                                <!-- <button class=" btn btn-primary btn-xs ml-3">Vazifalar</button> -->
                                <a href="{% url 'admintion:forms' %}"
                                    class=" btn btn-primary btn-xs ml-3"> <span data-feather="file-text"></span>Formalar</a>
                                <a href="{% url 'admintion:lead-list' %}?status=2"
                                    class=" btn btn-primary btn-xs ml-3"> <span data-feather="archive"></span>Arxiv</a>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-12 mb-30">
                <div class="card">
                    <div class="card-body">
                        <div class="userDatatable global-shadow border-0 bg-white w-100">
                            <form class="filter-form mb-4">
                                <div class="row">
                                    <div class="col-3">
                                        <input class="form-control mr-sm-2 box-shadow-none" type="text" placeholder="Search...">
                                    </div>
                                    <div class="col-2">
                                        <div class="atbd-select">
                                            <select name="select-courses" id="select-courses" class="form-control">
                                                <option value="" selected disabled>Manba</option>
                                                <option value="01">Option 1</option>
                                                <option value="02">Option 2</option>
                                                <option value="05">Option 3</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <div class="atbd-select ">
                                            <select name="select-groups" id="select-groups" class="form-control">
                                                <option value="" selected disabled>Holati</option>
                                                <option value="01">Option 1</option>
                                                <option value="02">Option 2</option>
                                                <option value="05">Option 3</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <div class="atbd-select ">
                                            <select name="select-teacher" id="select-teacher" class="form-control">
                                                <option value="" selected disabled>Xodimlar</option>
                                                <option value="01">Option 1</option>
                                                <option value="02">Option 2</option>
                                                <option value="05">Option 3</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-3">
                                        <div class="atbd-date-ranger position-relative m-0 d-flex align-items-center">
                                            <div class="form-group mb-0">
                                                <input type="text" name="date-range-from" class="form-control form-control-default" id="date-from-4" placeholder="Start" >
                                            </div>
                                            <span class="divider">-</span>
                                            <div class="form-group mb-0">
                                                <input type="text" name="date-range-to" class="form-control form-control-default" id="date-to-4" placeholder="End" >
                                            </div>
                                            <a class="date-picker-icon" href="#"><span data-feather="calendar"></span></a>
                                        </div>
                                    </div>
                                    
                                </div>
                            </form>
                            <div class="table-responsive">
                                <table class="table mb-0 table-borderless">
                                    <thead>
                                        <tr class="userDatatable-header">
                                            <th>
                                                <div class="d-flex align-items-center">
                                                    <div class="custom-checkbox  check-all">
                                                        <input class="checkbox" type="checkbox"
                                                            id="check-3">
                                                        <label for="check-3">
                                                            <span
                                                                class="checkbox-text userDatatable-title">FIO
                                                                & Telefon</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </th>
                                            <th>
                                                <span class="userDatatable-title">Manbasi</span>
                                            </th>
                                            <th>
                                                <span class="userDatatable-title">Holati</span>
                                            </th>

                                            <th>
                                                <span class="userDatatable-title">Izoh</span>
                                            </th>
                                            <th>
                                                <span class="userDatatable-title">Xodim & Sanasi</span>
                                            </th>
                                            <th>
                                                <span class="userDatatable-title float-right"><svg
                                                        xmlns="http://www.w3.org/2000/svg" width="24"
                                                        height="24" viewBox="0 0 24 24" fill="none"
                                                        stroke="currentColor" stroke-width="2"
                                                        stroke-linecap="round" stroke-linejoin="round"
                                                        class="feather feather-more-horizontal">
                                                        <circle cx="12" cy="12" r="1" />
                                                        <circle cx="19" cy="12" r="1" />
                                                        <circle cx="5" cy="12" r="1" />
                                                    </svg></span>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for lead in objs %}
                                        <tr>
                                            <td>
                                                <div class="d-flex">
                                                    <div
                                                        class="userDatatable__imgWrapper d-flex align-items-center">
                                                        <div class="checkbox-group-wrapper">
                                                            <div class="checkbox-group d-flex">
                                                                <div
                                                                    class="checkbox-theme-default custom-checkbox checkbox-group__single d-flex">
                                                                    <input class="checkbox leadCheckBox"
                                                                        type="checkbox"
                                                                        id="check-grp-{{lead.id}}">
                                                                    <label
                                                                        for="check-grp-{{lead.id}}"></label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- <a href="#" class="profile-image rounded-circle d-block m-0 wh-38" style="background-image:url('img/tm6.png'); background-size: cover;"></a> -->
                                                    </div>
                                                    <div class="userDatatable-inline-title">
                                                        <a href="{% url 'admintion:lead-detail' lead.id %}"
                                                            class="text-dark fw-500">
                                                            <h6>{{ lead.full_name }}</h6>
                                                        </a>
                                                        <p class="d-block mb-0">
                                                            {{ lead.phone_number }}
                                                        </p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="userDatatable-content">
                                                    {{ lead.source__title}}
                                                </div>
                                            </td>
                                            <td>
                                                <div class="userDatatable-content d-inline-block">
                                                    <span
                                                        class="bg-opacity-success  color-success rounded-pill userDatatable-content-status active">{{lead.status__status|default:'' }}</span>
                                                </div>

                                            </td>

                                            <td>
                                                <div class="userDatatable-content">
                                                    {{ lead.comment }}
                                                </div>
                                            </td>
                                            <td>
                                                <div class="d-flex">

                                                    <div class="userDatatable-inline-title">
                                                        <a href="#" class="text-dark fw-500">
                                                            <h6>
                                                                {{lead.author_name}}
                                                                <small><span
                                                                        class="bg-opacity-primary  color-primary b-2 userDatatable-content-status active">Havola orqali</span></small>
                                                                {{ lead.via_form__title }}
                                                            </h6>
                                                        </a>
                                                        <p class="d-block mb-0">
                                                            {{ lead.created_at|date:'d/m/Y -H:i' }}
                                                        </p>
                                                    </div>
                                                </div>
                                            </td>
                                            <td>
                                                <ul class="orderDatatable_actions mb-0 d-flex flex-wrap">

                                                    <li>
                                                        <a href="#" class="view drawer-trigger" data-drawer="profile">
                                                            <span data-feather="mail"></span></a>
                                                    </li>
                                                    <li>
                                                        <a href="#" class="edit" data-toggle="modal" data-target="#modal-phone">
                                                            <span data-feather="phone"></span></a>
                                                    </li>
                                                    <!-- <li>
                                                                <a href="#" class="view"  data-toggle="modal" data-target="#modal-basic1">
                                                                    <span data-feather="rotate-ccw"></span></a>
                                                            </li> -->
                                                    <!-- <li>
                                                                <a href="#" class="edit">
                                                                    <span data-feather="edit"></span></a>
                                                            </li> -->
                                                    <li>
                                                        <a href="#" class="remove"
                                                            onclick="changeModal('{{lead.id}}')"
                                                            data-toggle="modal" data-target="#modal-basic">
                                                            <span data-feather="trash-2"></span></a>
                                                    </li>
                                                </ul>
                                            </td>
                                        </tr>

                                        {% empty %}

                                        {% endfor %}

                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- <div class="d-flex justify-content-sm-end justify-content-start pt-25">
                            <nav class="atbd-page ">
                                <ul class="atbd-pagination d-flex">
                                    <li class="atbd-pagination__item">
                                        <a href="#" class="atbd-pagination__link pagination-control"><span class="la la-angle-left"></span></a>
                                        <a href="#" class="atbd-pagination__link"><span class="page-number">1</span></a>
                                        <a href="#" class="atbd-pagination__link active"><span class="page-number">2</span></a>
                                        <a href="#" class="atbd-pagination__link"><span class="page-number">3</span></a>
                                        <a href="#" class="atbd-pagination__link pagination-control"><span class="page-number">...</span></a>
                                        <a href="#" class="atbd-pagination__link"><span class="page-number">12</span></a>
                                        <a href="#" class="atbd-pagination__link pagination-control"><span class="la la-angle-right"></span></a>
                                        <a href="#" class="atbd-pagination__option">
                                        </a>
                                    </li>
                                    <li class="atbd-pagination__item">
                                        <div class="paging-option">
                                            <select name="page-number" class="page-selection">
                                                <option value="20">20/page</option>
                                                <option value="40">40/page</option>
                                                <option value="60">60/page</option>
                                            </select>
                                        </div>
                                    </li>
                                </ul>
                            </nav>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-basic modal" id="modal-basic1" tabindex="-1" role="dialog" aria-hidden="true">


        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header">



                    <h6 class="modal-title">Lidni aktivlashtirish.</h6>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span data-feather="x"></span></button>
                </div>
                <div class="modal-body">
                    <p>Ushbu lid avtiv lidlar qatoriga kiritilsinmi?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary btn-sm" id="activateBtn">Ha</button>
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Yoq</button>
                </div>
            </div>
        </div>


    </div>
    <div class="modal-basic modal" id="modal-basic2" tabindex="-1" role="dialog" aria-hidden="true">


        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header">



                    <h6 class="modal-title">Sms matni.</h6>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span data-feather="x"></span></button>
                </div>
                <div class="modal-body">
                    <div class="sms-status-message"></div>
                    <form action="#">
                        <div class="form-row">
                            <div class="form-group col-lg-12">
                                <label for="id_message">Xabar matni</label>
                                <textarea type="text" name="id_message" id="id_message"
                                    class="form-control form-control-sm border-light"
                                    placeholder="Xabar matni..."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary btn-sm" id="sendSMS">Jo'natish</button>
                    <button type="button" class="btn btn-secondary btn-sm" id="cancelSMS" ,
                        data-dismiss="modal">Bekor qilish</button>
                </div>
            </div>
        </div>


    </div>
    <div class="modal-basic modal" id="modal-phone" tabindex="-1" role="dialog"
            aria-hidden="true">
            <div class="modal-dialog modal-md" role="document">
                <div class="modal-content modal-bg-white ">
                    <div class="modal-header">
                        <h6 class="modal-title">Telefon qilish</h6>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span data-feather="x"></span></button>
                    </div>
                    <div class="modal-body">
                        <p>IP telefoniya(virtual raqam) xizmati sizning tarifingizda ulanmagan. Ushbu
                            xizmatni ulash yoki batafsil ma'lumot olish uchun qo'llab-quvvatlash markaziga
                            murojaat qiling. </p>
                    </div>
                    <div class="modal-footer">
                        <!-- <button type="button" class="btn btn-primary btn-sm">Ha</button> -->
                        <button type="button" class="btn btn-primary btn-sm"
                            data-dismiss="modal">Rahmat</button>
                    </div>
                </div>
            </div>


        </div>
    <div class="drawer-basic-wrap">
        <div class="atbd-drawer drawer-account d-none" style="overflow: scroll;">
            <div class="atbd-drawer__header d-flex aling-items-center justify-content-between">
                <h6 class="drawer-title">Yangi lid qo’shish</h6>
                <a href="#" class="btdrawer-close"><i class="la la-times"></i></a>
            </div><!-- ends: .atbd-drawer__header -->
            <div class="atbd-drawer__body">
                <div class="drawer-content">
                    <div class="drawer-account-form form-basic">
                        <form action="{% url 'admintion:lead-list' %}" method="post">
                            {% csrf_token %}
                            <div class="form-row">
                                <div class="form-group col-lg-6">
                                    <label for="fio">Ism</label>
                                    <input type="text" name="fio" id="fio"
                                        class="form-control form-control-sm border-light"
                                        placeholder="Isminggiz...">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label for="tel">Telefon raqam</label>
                                    <input type="text" name="phone" id="tel"
                                        class="form-control form-control-sm border-light"
                                        placeholder="(99) 123-45-67">
                                </div>
                                <div class="form-group col-lg-6">
                                    <label for="manba">Manbasi</label>
                                    <select name="manba" id="manba" class="form-control-sm border-light">
                                        <option value="0">-----------</option>
                                        {% for source in sources %}
                                        <option value="{{source.id}}">{{ source.title }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group col-lg-6">
                                    <label for="hol">Holati</label>
                                    <select name="hol" id="hol" class="form-control-sm border-light">
                                        <option value="0">-----------</option>
                                        {% for status in lead_statuses %}
                                        <option value="{{status.id}}">{{ status.status }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="form-group col-12">
                                    <label for="description">Izoh</label>
                                    <textarea name="description" id="description"
                                        class="form-control border-light form-control-sm"
                                        placeholder="Izoh"></textarea>
                                </div>
                                <div class="col-12 view-form form-row">
                                </div>
                                <div class="col-12">
                                    <div class="buttons d-flex flex-wrap  w-100">
                                        <button type="button"
                                            class="btn btn-icon btn-circle btn-outline-primary mr-3 btn-parents">
                                            <span data-feather="users"></span>
                                            <!-- <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" class="feather feather-users">
                                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                                                <circle cx="9" cy="7" r="4" />
                                                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                                                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                                            </svg> -->
                                        </button>
                                        <button type="button"
                                            class="btn btn-icon btn-circle btn-outline-primary mr-3 btn-telegram">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" class="feather feather-send">
                                                <line x1="22" y1="2" x2="11" y2="13" />
                                                <polygon points="22 2 15 22 11 13 2 9 22 2" />
                                            </svg>
                                        </button>
                                        <button type="button"
                                            class="btn btn-icon btn-circle btn-outline-primary mr-3 btn-location">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" class="feather feather-map-pin">
                                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                                                <circle cx="12" cy="10" r="3" />
                                            </svg>
                                        </button>
                                        <button type="button"
                                            class="btn btn-icon btn-circle btn-outline-primary  mr-3 btn-email">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" class="feather feather-mail">
                                                <path
                                                    d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                                                <polyline points="22,6 12,13 2,6" />
                                            </svg>
                                        </button>
                                        <button type="button"
                                            class="btn btn-icon btn-circle btn-outline-primary  mr-3 btn-pasport">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" class="feather feather-file-text">
                                                <path
                                                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                                <polyline points="14 2 14 8 20 8" />
                                                <line x1="16" y1="13" x2="8" y2="13" />
                                                <line x1="16" y1="17" x2="8" y2="17" />
                                                <polyline points="10 9 9 9 8 9" />
                                            </svg>
                                        </button>
                                        <button type="button"
                                            class="btn btn-icon btn-circle btn-outline-primary  mr-3 btn-file">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="feather feather-upload-cloud">
                                                <polyline points="16 16 12 12 8 16" />
                                                <line x1="12" y1="12" x2="12" y2="21" />
                                                <path
                                                    d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3" />
                                                <polyline points="16 16 12 12 8 16" />
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <a href="#" class="text-right d-block col-12"
                                    onclick="handleAddGroup()">+Guruhga
                                    qo'shish: </a>
                                <div class="group_add"></div>
                                <a href="#" class="text-right d-block col-12"
                                    onclick="handleAddTask()">+Topshiriq
                                    qo’shish: </a>
                                <div class="task_add"></div>
                            </div>
                            <button type="submit"  class="btn btn-primary">Saqlash</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="atbd-drawer drawer-profile d-none">
            <div class="atbd-drawer__header d-flex aling-items-center justify-content-between">
                <h6 class="drawer-title">SMS yuborish</h6>
                <a href="#" class="btdrawer-close"><i class="la la-times"></i></a>
            </div><!-- ends: .atbd-drawer__header -->
            <div class="atbd-drawer__body">
                <div class="drawer-content">
                    <div class="drawer-account-form form-basic">
                        <form action="#">
                            <div class="form-row">

                                <div class="form-group col-12">
                                    <label for="description">Xabar matni</label>
                                    <textarea name="description" id="description"
                                        class="form-control form-control-sm"
                                        placeholder="Xabar matnini kiriting..."></textarea>
                                </div>

                                <div class="form-group col-12">
                                    <small id="small_code"></small>
                                </div>
                                <div class="form-group col-12">
                                    <a href="./sms_yoriqnoma.html">SMSda simvollarni ishlatish bo'yicha
                                        yo'riqnoma</a>
                                </div>
                                <div class="form-group col-12">
                                    <div class="btn btn-primary">Yuborish</div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div><!-- ends: .atbd-drawer__body -->
        </div>

        <div class="overlay-dark"></div>
        <div class="overlay-dark-l2"></div>
    </div>




    <div class="modal-basic modal" id="modal-basic" tabindex="-1" role="dialog" aria-hidden="true">


        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header">
                    <h6 class="modal-title">Lidni o'chirish</h6>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span data-feather="x"></span></button>
                </div>
                <div class="modal-body">
                    <p>Ushbu arxivdagi lidni haqiqatdan ham o'chirmoqchimisiz?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary btn-sm" id="deleteBtn">Ha,
                        o'chirilsin</button>
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Bekor
                        qilish</button>
                </div>
            </div>
        </div>


    </div>
    <div class="modal-basic modal" id="modal-basic1" tabindex="-1" role="dialog" aria-hidden="true">


        <div class="modal-dialog modal-md" role="document">
            <div class="modal-content modal-bg-white ">
                <div class="modal-header">



                    <h6 class="modal-title">Lidni avtivlashtirish.</h6>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span data-feather="x"></span></button>
                </div>
                <div class="modal-body">
                    <p>Ushbu lid avtiv lidlar qatoriga kiritilsinmi?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary btn-sm">Ha</button>
                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Yoq</button>
                </div>
            </div>
        </div>


    </div>
</div>
<!-- ends: .atbd-page-content -->

    {% endblock %}
    {% block script %}
    <script>
        var params = new URLSearchParams(window.location.search)
        if (params.has('success')) {
            alert("malumotlar qo'shildi")
        }
        else if (params.has('error')) {
            alert("Malumotlar to\'liq kiritilmadi")
        }
    </script>
    <script>

        // function reload() {
        //     window.location.reload()
        // }

        // function createTasks(user, lead) {
        //     console.log("create Tasks")

        //     var url = `/education/task/add/`;

        //     var formData = new FormData();
        //     formData.append('csrfmiddlewaretoken', '{{ csrf_token }}')

        //     var taskSelected = document.querySelector('.tasksID');
        //     if (taskSelected.value != 0) {
        //         formData.append('task_type', taskSelected.value);
        //     }
        //     var responsibles = document.querySelector('#select-tag');
        //     for (var i = 0; i < responsibles.selectedOptions.length; i++) {
        //         formData.append('responsibles', responsibles.selectedOptions[i].value);
        //     }

        //     var deadline = document.querySelector('#deadline');
        //     if (deadline.value != undefined || deadline.value != null) {
        //         formData.append('deadline', deadline.value);
        //     }
        //     var comment = document.querySelector('#id_comment');
        //     formData.append('comment', comment.value);

        //     formData.append('user_status', 1);
        //     formData.append('whom', user);
        //     formData.append('leads', lead)
        //     if (deadline.value && responsibles.selectedOptions.length && taskSelected.value) {
        //         fetch(url, {
        //             method: 'post',
        //             headers: {
        //                 'X-CSRFToken': '{{ csrf_token }}',
        //             },
        //             body: formData,
        //         })
        //             .then(res => {
        //                 if (res.status == 201) {
        //                     reload()
        //                 }
        //             })
        //             .catch(err => {
        //                 console.log(err);
        //             })
        //     } else {
        //         reload()
        //     }

        // }
        // var group = document.getElementsByClassName('demoID')[0];
        // group.addEventListener('change', (event) => {
        //     var url = `/admintion/group/${event.target.value}/data/`
        //     fetch(url, {
        //         method: 'get',
        //         headers: {
        //             'Accept': 'application/json',
        //         }
        //     })
        //         .then(res => res.json())
        //         .then(res => {
        //             var group_days = document.getElementById('select-tag-group-days');
        //             group_days.options.length = 0;
        //             for (var i = 0; i < res.group.dates.length; i++) {
        //                 var option = new Option(`${res.group.dates[i].date}| ${res.group.dates[i].day}`, `${res.group.dates[i].date}`);
        //                 group_days.add(option);
        //             }
        //         })
        //         .catch(err => {
        //             alert(err);
        //         })
        // })

        // function createDemo(lead, user) {
        //     var url = `/admintion/leads/add-demo/`;
        //     var formData = new FormData();
        //     var dates = document.getElementById('select-tag-group-days').selectedOptions;

        //     formData.append('form-INITIAL_FORMS', 0);
        //     formData.append('form-TOTAL_FORMS', dates.length);


        //     for (var i = 0; i < dates.length; i++) {
        //         if (document.querySelectorAll(".demoID")[0].value && document.querySelectorAll(".demoID")[0].value != 0) {
        //             formData.append(`form-${i}-group`, document.querySelectorAll(".demoID")[0].value);
        //         }
        //         formData.append(`form-${i}-lead`, lead);
        //         formData.append(`form-${i}-date`, dates[i].value)
        //     }

        //     formData.append('csrfmiddlewaretoken', '{{ csrf_token }}')
        //     fetch(url, {
        //         method: 'post',
        //         headers: {
        //             'X-CSRFToken': '{{ csrf_token }}'
        //         },
        //         body: formData
        //     })
        //         .then(res => res.json())
        //         .then(res => {
        //             createTasks(user, lead);

        //         })
        //         .catch(err => {
        //             console.log(err);
        //         })
        // }


        // function createLead(id) {
        //     var url = `/admintion/leads/create/`;
        //     var formData = new FormData();
        //     formData.append('csrfmiddlewaretoken', '{{ csrf_token }}')
        //     formData.append('user', id);


        //     source = document.querySelector('#manba');
        //     console.log("source: ", source.value)
        //     if (source.value && source.value != 0) {
        //         formData.append('source', source.value);
        //     }


        //     status = document.querySelector('#hol');
        //     console.log("status: ", status, document.querySelector('#hol').value)
        //     if (document.querySelector('#hol').value && document.querySelector('#hol').value != "0") {
        //         formData.append('status', document.querySelector('#hol').value);
        //     }

        //     comment = document.querySelector('#description');
        //     if (comment.value && comment.value != 0) {
        //         formData.append('comment', comment.value);
        //     }

        //     parents = document.querySelector('#parents');
        //     if (parents.value && parents.value != 0) {
        //         formData.append('parents', parents.value);
        //     }

        //     p_phone = document.querySelector('#pparents');
        //     if (p_phone.value && p_phone.value != 0) {
        //         formData.append('p_phone', p_phone.value);
        //     }

        //     telegram = document.querySelector('#telegram_num');
        //     if (telegram.value && telegram.value != 0) {
        //         formData.append('telegram', telegram.value);
        //     }



        //     passport = document.querySelector('#id_passport');
        //     if (passport.value && passport.value != 0) {
        //         formData.append('passport', passport.value);
        //     }

        //     file = document.querySelector('#id_file');
        //     if (file && file.files[0]) {
        //         formData.append('file', file.files[0], file.files[0].name);
        //     }



        //     days = document.querySelector('#select-tag-days');
        //     if (days.selectedOptions) {
        //         var days_arr = []
        //         for (var i = 0; i < days.selectedOptions.length; i++) {
        //             days_arr.push(days.selectedOptions[i].value);
        //         }
        //         for (var i = 0; i < days_arr.length; i++) {
        //             formData.append('days', days_arr[i]);
        //         }
        //         console.log(formData);
        //     }

        //     course = document.querySelectorAll('.course-select')[0];
        //     if (course.value != "0") {
        //         formData.append('course', document.querySelectorAll('.course-select')[0].value)
        //     }

        //     fetch(url, {
        //         method: "post",
        //         headers: {
        //             'X-CSRFToken': '{{ csrf_token }}',
        //         },
        //         body: formData,
        //     })
        //         .then(res => res.json())
        //         .then(res => {
        //             if (res) {
        //                 createDemo(res.id, id);
        //             } else {
        //                 alert("Ma'lumotlar to'liq kiritilmadi");;
        //             }
        //         })
        //         .catch(err => {
        //             alert(err);
        //         })



        // }

        // function createUser() {
        //     var url = `/user/create/`;
        //     var formData = new FormData();
        //     formData.append('csrfmiddlewaretoken', '{{ csrf_token }}')
        //     first_name = document.querySelector("#fio");
        //     formData.append('first_name', fio.value.split(' ')[1]);
        //     formData.append('last_name', fio.value.split(' ')[0]);
       
        //     phone = document.querySelector('#tel');
            
        //     formData.append('phone', phone.value);
        //     formData.append('password', phone.value);
        //     address = document.querySelector('#id_manzil');
        //     if (address) {
        //         formData.append('location', address.value);
        //     }
        //     email = document.querySelector('#id_email');
        //     if (email) {
        //         formData.append('email', email.value);
        //     }
        //     birthday = document.querySelector('#id_birthday');
        //     if (birthday) {
        //         formData.append('birthday', birthday.value);
        //     }

        //     var radiov1 = document.querySelector("#radio-vl1");
        //     var radiov2 = document.querySelector("#radio-vl2");
        //     if (radiov1) {
        //         if(radiov1.checked == true){
        //             formData.append('gender', '1');
        //         }
        //     }
        //     else if (radiov2) {
        //         if(radiov1.checked == true){
        //             formData.append('gender', '2');
        //         }
                
        //     }
        //     fetch(url, {
        //         method: "post",
        //         headers: {
        //             'X-CSRFToken': '{{ csrf_token }}',
        //         },
        //         body: formData,
        //     })
        //         .then(res => res.json())
        //         .then(res => {
        //             if (res) {
        //                 createLead(res.id);
        //             } else {
        //                 alert("Ma'lumotlar to'liq kiritilmadi");;
        //             }
        //         })
        //         .catch(err => {
        //             alert(err);
        //         })

        // }

        // function save() {
        //     createUser();
        // }


        // function changeLeadStatus(id,) {
        //     var url = `/admintion/leads/${id}/archive/`;
        //     fetch(url, {
        //         method: 'get',
        //         headers: {
        //             'Accept': 'application/json',
        //         },
        //     })
        //         .then(res => {
        //             window.location.reload()
        //         })
        //         .catch(err => {
        //             console.log(err);
        //         })
        // }


        // function changeModal(id) {
        //     console.log(id);
        //     btn = document.getElementById('deleteBtn');
        //     btn.setAttribute('onclick', `changeLeadStatus('${id}')`)
        //     console.log(btn);
        // }

        // var cancelBtn = document.getElementById('cancelSMS');
        // cancelBtn.addEventListener('click', () => {
        //     var input = document.getElementById('id_message');
        //     input.value = '';
        // })

        // var sendSMS = document.getElementById('sendSMS');
        // sendSMS.addEventListener('click', () => {
        //     var formData = new FormData();
        //     formData.append('csrfmiddlewaretoken', '{{ csrf_token }}')
        //     var input = document.getElementById('id_message');
        //     formData.append('message', input.value);

        //     var checkboxes = document.getElementsByClassName('leadCheckBox');
        //     var leads = []
        //     for (var i = 0; i < checkboxes.length; i++) {
        //         if (checkboxes[i].checked == true) {
        //             formData.append('leads', checkboxes[i].id.split('-')[2]);
        //         }
        //     }

        //     var url = `{% url 'admintion:send_sms_to_lead' %}`
        //     fetch(url, {
        //         method: 'post',
        //         headers: {
        //             'X-CSRFToken': '{{ csrf_token }}'
        //         },
        //         body: formData,
        //     })
        //         .then(res => {
        //             var status = res.status
        //             return res;
        //         })
        //         .then(res => res.json())
        //         .then(res => {
        //             if (status == 200) {
        //                 alert("Xabar Lidlarga yuborildi.");
        //             } else {
        //                 alert("Ma'lumotlar to'liq kiritilmadi");;
        //             }
        //         })
        // })

        // function checkedLeads() {
        //     var checkboxes = document.getElementsByClassName('leadCheckBox');
        //     var leads = []
        //     for (var i = 0; i < checkboxes.length; i++) {
        //         if (checkboxes[i].checked == true) {
        //             leads.push(checkboxes[i].id.split('-')[2]);
        //         }
        //     }
        //     var formData = new FormData();
        //     formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');
        //     for (var i = 0; i < leads.length; i++) {
        //         formData.append('leads', leads[i]);
        //     }
        //     // var url = "{% url 'admintion:check-sms-availability' %}";
        //     fetch("{% url 'admintion:check-sms-availability' %}", {
        //         method: 'post',
        //         headers: {
        //             'Accept': 'application/json',
        //             'X-CSRFToken': '{{ csrf_token }}'
        //         },
        //         body: formData
        //     })
        //         .then(res => res.json())
        //         .then(res => {
        //             var div = document.getElementsByClassName('sms-status-message')[0];
        //             //div.classList.add('d-flex m-2 p-2')
        //             div.innerHTML = `<p class="mb-3">Sms yuboriladigan foydalanuvchilar soni: ${res.users}<br>
        //                      Sizda jami ${res.sms_limit} ta miqdorida bonus sifatidagi smslar mavjud. Bu limit tugagach,
        //                     sizdan sms integratsiya qilingan email va parol so'raladi.  </p>             
        //     `
        //         })
        //         .catch(err => {
        //             console.log(err);
        //         })
        // }

        
        var formName = document.querySelector(".form-name");
        var formPhone = document.querySelector(".form-phone");
        var formDate = document.querySelector(".form-birthdate");
        var formGender = document.querySelector(".form-gender");

        function validation(element,action){
            element.addEventListener(action,(evt)=>{
            if(evt.target.value){
                evt.target.className = "is-valid form-control ih-medium ip-light radius-xs b-light form-name";
            } else{
                evt.target.className = "is-invalid form-control ih-medium ip-light radius-xs b-light form-name";
            }
        })
        }
        if(formDate){
            validation(formName,"input")
        }
        // validation(formName,"input")
        // alert(92)
        // validation(formDate,"input")
        // alert(93)
        // validation(formGender,"change")

        
        // formPhone.addEventListener("input",(evt)=>{
        //     if(evt.target.value.length<=4){
        //         evt.target.value = "+998"
        //     } 
        //     if(evt.target.value.length<=9){
        //         var value = "+" + evt.target.value.match(/\d/g).join("")
        //         evt.target.value = value
        //     }
        //     if(evt.target.value.length==12){
        //         validation(formPhone,"input")
        //     }
            
        // })
        
        var form = document.querySelector('.view-form');
        function handleAddItem(_id, names, labelName, typs, plcs, btn, isActive) {
            var doc_id = document.querySelector('#' + _id)
            if (!doc_id) {
                var wrap = document.createElement('div');
                wrap.classList.add(...['form-group', 'row', 'w-100', 'mx-0']);
                wrap.id = _id;
                var label = document.createElement('label');
                label.for = "a" + names[0];
                label.classList.add(...['il-gray', 'fs-14', 'fw-500', 'align-center', 'col-md-12']);
                label.textContent = labelName;
                wrap.appendChild(label);
                typs.map((item, index) => {
                    var input = document.createElement('input');
                    input.type = item;
                    input.classList.add(...['col-md-' + Math.floor(10 / typs.length), 'form-control', 'ih-medium', 'ip-light', 'radius-xs', 'b-light', 'px-15', 'mx-2']);
                    input.id = "a" + names[index];
                    input.name = `${_id.split("-")[0]}_${names[index]}`;
                    input.placeholder = plcs[index];
                    wrap.appendChild(input);
                    input = null;
                })
                var img = document.createElement('p');
                img.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>`
                // var img = document.createElement('img');
                // img.src = "{% static 'img/svg/ixis.svg' %}";
                img.className = "ml-auto";
                img.addEventListener('click', function () {
                    document.querySelector('#' + _id).remove()
                    isActive = false
                    console.log(isActive)
                    btn.className = "btn btn-icon btn-circle btn-outline-primary mr-3"
                })
                wrap.appendChild(img);
                form.appendChild(wrap);
                label = null;
            }
            else {
                doc_id.remove()
            }
        }
        
        var  parentsBtn = document.querySelector(".btn-parents")
        var  telegramBtn = document.querySelector(".btn-telegram")
        var  locationBtn = document.querySelector(".btn-location")
        var  emailBtn = document.querySelector(".btn-email")
        var  pasportBtn = document.querySelector(".btn-pasport")
        var  fileBtn = document.querySelector(".btn-file")
    
        function setActiveBtn(btn, ...props){
            var isActive = false;
            btn.addEventListener("click",(evt)=>{
            if(isActive){
                isActive = false;
                btn.className = "btn btn-icon btn-circle btn-outline-primary mr-3"
            } else{
                isActive=true;
                btn.className = "btn btn-icon btn-circle btn-primary mr-3"
            }
            handleAddItem(...props, btn, isActive)
        })
        }
        
        setActiveBtn(parentsBtn, 'parent-23',['name','phone'],'Ota-ona',['text','text'],['Ota-ona...','(99) 134-56-87'])
        setActiveBtn(telegramBtn, 'telegram-23',['telegram'],'Telegram',['text'],['(99) 134-56-87'])
        setActiveBtn(locationBtn, 'location-23',['location'],'Manzil',['text'],['Manzil...'])
        setActiveBtn(emailBtn, 'email-23',['location'],'Email',['email'],['Email...'])
        setActiveBtn(pasportBtn, 'password-23',['password'],'Passport',['text'],['AA0000000'])
        setActiveBtn(fileBtn, 'file-23',['file'],'Fayl Yuklash',['file'],['AA0000000'])

        

        var cancelBtn = document.getElementById('cancelSMS');
        cancelBtn.addEventListener('click', ()=>{
            var input = document.getElementById('id_message');
            input.value = '';
        })
    
        var sendSMS = document.getElementById('sendSMS');
        sendSMS.addEventListener('click', ()=>{
            var formData = new FormData();
            formData.append('csrfmiddlewaretoken', '{{ csrf_token }}')
            var input = document.getElementById('id_message');
            formData.append('message', input.value);
            var checkboxes = document.getElementsByClassName('studentCheckbox');
            for(var i=0;i<checkboxes.length;i++){
                if(checkboxes[i].checked == true){
                    formData.append('students', checkboxes[i].id.split('-')[2]);
                }
            }
            var url = `{% url 'admintion:send_sms_to_student' %}`
            fetch(url, {
                method:'post',
                headers:{
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: formData,
            })
            .then(res=>{
                
                if(res.status==200){
                    alert("Xabar O'quvchilarga yuborildi.");
                    var input = document.getElementById('id_message');
                    input.value = '';
                } else {
                    alert("Ma'lumotlar to'liq kiritilmadi");;
                } 
            })
        })
    
        function checkedStudents(){
            var checkboxes = document.getElementsByClassName('studentCheckbox');
            var leads = []
            for(var i=0;i<checkboxes.length;i++){
                if(checkboxes[i].checked == true) {
                    leads.push(checkboxes[i].id.split('-')[2]);
                }
            }
            var formData = new FormData();
            formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');
            for(var i=0;i< leads.length;i++){
                formData.append('students', leads[i]);
            }
            // var url = "{% url 'admintion:check-sms-availability' %}";
            fetch("{% url 'admintion:check-sms-availability' %}", {
                method:'post',
                headers:{
                    'Accept':'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                body: formData
            })
            .then(res=>res.json())
            .then(res=>{
                var div = document.getElementsByClassName('sms-status-message')[0];
                //div.classList.add('d-flex m-2 p-2')
                div.innerHTML = `<p class="mb-3">Sms yuboriladigan foydalanuvchilar soni: ${res.users}<br>
                                 Sizda jami ${res.sms_limit} ta miqdorida bonus sifatidagi smslar mavjud. Bu limit tugagach,
                                sizdan sms integratsiya qilingan email va parol so'raladi.  </p>             
                `
            })
            .catch(err=>{
                console.log(err);
            })
        }
    
        function handleStudentDelete(id){
            var tr = document.querySelector(`#student-${id}`);
            fetch(`/admintion/student/${id}/delete/`, {
                method:'post',
                headers:{
                    'Accept':'application/json',
                    'X-CSRFToken': '{{ csrf_token }}'
                }
            })
            .then(res=>res.json())
            .then(res=>{
               if(res.status==302){
                tr.remove();
               }
            })
            .catch(err=>{
                
            })
        }
        
        function handleAddGroup(){
            var group_add = document.querySelector('.group_add');
            group_add.className='row w-100 group_add d-flex';
            if(group_add.innerHTML){
                group_add.innerHTML="";
                return;
            }
            
            // fetch("{% url 'admintion:group-list' %}", {
            //     method:'post',
            //     headers:{
            //         'Accept':'application/json',
            //         'X-CSRFToken': '{{ csrf_token }}'
            //     }
            // })
            // .then(res=>res.json())
            // .then(res=>{
            //    console.log(res)
            //    var select = document.createElement('select');
            //    var label = document.createElement('label')
            //    select.name='group';
            //    res.data.map((item)=>{
            //         var option = document.createElement('option');
            //         option.value = item.id;
            //         option.textContent = item.title;
            //         select.appendChild(option);
            //    })
            //    label.className='il-gray fs-14 fw-500 align-center';
            //    select.className='form-control px-15';
            //    wrap.appendChild(label);
            //    wrap.appendChild(select)
            //    group_add.appendChild(wrap)
            // })
            // .catch(err=>{
            //     console.log(err)
            // })
            
            ["Guruh","Vaqti"].map((item)=>{
                if(item === "Vaqti"){
                    var wrap = document.createElement('div');
                    wrap.className='form-group col-md-6';
                    var calendar = `
                        <div class="atbd-date-picker">
                            <div class="form-group mb-0 form-group-calender">
                                <div class="position-relative">
                                    <label for="datepickre2">${item}</label>
                                    <input type="text" class="form-control form-control-default" id="datepicker2" placeholder="January 20, 2018">
                                    <a href="#"><span data-feather="calendar"></span></a>
                                </div>
                            </div>
                        </div>
                    `
                    wrap.innerHTML = calendar;
                    group_add.appendChild(wrap)
                } else{
                var wrap = document.createElement('div');
                wrap.className='form-group col-md-6';
                var select = document.createElement('select');
                var label = document.createElement('label');
                select.name=item;

               ["option1","option2"].map((item)=>{
                    var option = document.createElement('option');
                    option.value = item.id;
                    option.textContent = item;
                    select.appendChild(option);
               })
               label.textContent=item;
               label.className='il-gray fs-14 fw-500 align-center';
               select.className='form-control px-15';
               wrap.appendChild(label);
               wrap.appendChild(select)
               group_add.appendChild(wrap)
                }
                
            })
               
        }

        function handleAddTask(){
            // var wrap = document.createElement('div');
            // var group_add = document.querySelector('.task_add');
            // group_add.className='row w-100 task_add';
            // wrap.className='form-group col-md-12';
            // if(group_add.innerHTML){
            //     group_add.innerHTML="";
            //     return;
            // }
            // fetch("{% url 'admintion:group-list' %}", {
            //     method:'post',
            //     headers:{
            //         'Accept':'application/json',
            //         'X-CSRFToken': '{{ csrf_token }}'
            //     }
            // })
            // .then(res=>res.json())
            // .then(res=>{
            //    console.log(res)
            //    var select = document.createElement('select');
            //    var label = document.createElement('label')
            //    select.name='task';
            //    res.data.map((item)=>{
            //         var option = document.createElement('option');
            //         option.value = item.id;
            //         option.textContent = item.title;
            //         select.appendChild(option);
            //    })
            //    label.className='il-gray fs-14 fw-500 align-center';
            //    select.className='form-control px-15';
            //    wrap.appendChild(label);
            //    wrap.appendChild(select)
            //    group_add.appendChild(wrap)
            // })
            // .catch(err=>{
            //     console.log(err)
            // })

            var task_add = document.querySelector('.task_add');
            task_add.className='row w-100 task_add d-flex';
            if(task_add.innerHTML){
                task_add.innerHTML="";
                return;
            }

            ["Ma'sul","Topshiriq mavzusi","Vaqti","Topshiriq matni"].map((item)=>{
                if(item === "Vaqti"){
                    var wrap = document.createElement('div');
                    wrap.className='form-group col-md-12';
                    var calendar = `
                        <div class="atbd-date-picker">
                            <div class="form-group mb-0 form-group-calender">
                                <div class="position-relative">
                                    <label for="datepickre2">${item}</label>
                                    <input type="text" class="form-control form-control-default" id="datepicker2" placeholder="January 20, 2018">
                                    <a href="#"><span data-feather="calendar"></span></a>
                                </div>
                            </div>
                        </div>
                    `
                    wrap.innerHTML = calendar;
                    task_add.appendChild(wrap)
                } else if(item === "Topshiriq matni") {
                    console.log(item)
                    var wrap = document.createElement('div');
                    wrap.className='form-group col-md-12';
                    var textarea = `
                            <label for="task-comment"
                                class="il-gray fs-14 fw-500 align-center">${item}</label>
                            <textarea name="comment" class="form-control" id="task-comment"
                                rows="3"></textarea>
                    `
                    wrap.innerHTML= textarea;


                    task_add.appendChild(wrap)
                }
                else{
                var wrap = document.createElement('div');
                wrap.className='form-group col-md-6';
                var select = document.createElement('select');
                var label = document.createElement('label');
                select.name=item;

               ["option1","option2"].map((item)=>{
                    var option = document.createElement('option');
                    option.value = item.id;
                    option.textContent = item;
                    select.appendChild(option);
               })
               label.textContent=item;
               label.className='il-gray fs-14 fw-500 align-center';
               select.className='form-control px-15';
               wrap.appendChild(label);
               wrap.appendChild(select)
               task_add.appendChild(wrap)
                }
                
            })
               
        }


    </script>
    <script type="text/javascript">
        var url_path = '/admintion/students/filter?';
        var params = {
            student__status:'',
            group__id:'',
            group__course__id:'',
            group__teacher__id:''
        }
        function generate_path(){
            parms = new URLSearchParams(params);
            return url_path+parms
        }
        //students list 
        function request_form(url,headers,func){
            return fetch(url, headers)
            .then(res=>res.json())
            .then(res=>{
                if(res.status==200){
                    func(res.data)
                } else {
                    alert("Ma'lumotlar to'liq kiritilmadi");;
                } 
            }).catch(err=>{  
            })
        }
        function get_request(url,func){
            return (
                request_form(url,{
                method:'get',
                headers:{
                    'X-CSRFToken': '{{ csrf_token }}'
                },
            },func)
            )
        }
    
        function createCheckbox(dflex,student_id){
            var wrapimg = document.createElement('div');
            wrapimg.className='userDatatable__imgWrapper d-flex align-items-center';
            var checkboxWrap = document.createElement('div');                                 
            checkboxWrap.className='checkbox-group-wrapper';
            var checkboxGroup = document.createElement('div');
            checkboxGroup.className='checkbox-group d-flex';
            var checkboxTheme = document.createElement('div');
            checkboxTheme.className='checkbox-theme-default custom-checkbox checkbox-group__single d-flex';
            var checkInput = document.createElement('input');
            checkInput.className='checkbox studentCheckbox';
            checkInput.type='checkbox';
            checkInput.id=`check-grp-${student_id}`;
            checkboxTheme.appendChild(checkInput)
            checkboxGroup.appendChild(checkboxTheme)
            checkboxWrap.appendChild(checkboxGroup);
            wrapimg.appendChild(checkboxWrap);
            return wrapimg;
        }
    
        function studentList(datas){
            console.log(datas)
            var tbody = document.querySelector('tbody');
    
            while(tbody.firstChild) {
                tbody.removeChild(tbody.firstChild);
                }
            datas.forEach(element => {
                alert(3)
                var tr = document.createElement('tr');
                tr.id = `student-${element.student_ids}`
                var columns = ['check','id','fio','phone','group_count','attendance','balance','status','action']
                
                for(var i=0;i<columns.length;i++){
                    if(columns[i]=='check'){
                        var td = document.createElement('td');
                        var dflex = document.createElement('dev');
                        dflex.className='d-flex';
                        dflex.appendChild(createCheckbox(dflex,element.student_ids));
                        td.appendChild(dflex);
                        tr.appendChild(td);
                    }
                    else if(columns[i] in ['fio','status','action','id']){
    
                        // <div class="userDatatable-content">
                        //                             {{ student.payment|readable_soums }}
                        //                         </div>
                        
                    }
                    else {
                        
                        var td = document.createElement('td');
                        var dcontent = document.createElement('dev');
                        // td.style.display='block'
                        dcontent.className='userDatatable-content'
                        td.textContent=element[columns[i]];
                        // td.appendChild(dcontent);
                        tr.appendChild(td);
                    }
                }
                tbody.appendChild(tr);
                console.log(tbody)
                var dvTd = document.createElement('div');
                dvTd.className='userDatatable-content';
    
    
            });
        }
        function _onStatusDropdownChanged (e,name){
                
            var selected = e.target.value;
            if (selected != 0){
                params[name]=e.target.value
            } else {
                params[name]=''
            }
            get_request(generate_path(),studentList)
    
    }
    </script>

    {% endblock %}